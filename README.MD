# PrinterExorcism

ğŸ–¨ï¸ **PrinterExorcism** is a two-phase PowerShell module that forcefully and safely purges all user-linked and system-linked printers â€” with surgical precision and a flair for drama. It provides discovery, GPO comparison, user-mode cleanup, elevated retries, and full system-wide printer exorcisms.

## ğŸ“¦ Features

- âœ… **User-mode Phase 1** cleanup (no admin required)
- ğŸ” **Elevated Phase 2** retry for failed steps
- ğŸ“œ Structured logging via JSON + CLI logs
- ğŸ” Printer discovery (registry, WMI, `Get-Printer`)
- ğŸ§¼ Registry cleanup (HKCU + HKLM)
- ğŸª“ Ghost printer detection and removal
- ğŸ“Š GPO comparison mode
- ğŸ§™ `Make-PrintersSuffer` dramatic wrapper included
- ğŸ›ï¸ Logging levels: `Info`, `Warning`, `Critical`, `Debug`

---

## ğŸ§ª Installation

```powershell
irm https://raw.githubusercontent.com/r0tifer/PrinterExorcism/main/Install.ps1 | iex
```

> **Or clone directly:**
```powershell
git clone https://github.com/r0tifer/PrinterExorcism.git; Import-Module .\PrinterExorcism\PrinterExorcism.psm1
```

---

## ğŸ Usage

### Show CLI Help
```powershell
Start-PrinterExorcismSession
```

### Discovery Mode
```powershell
Start-PrinterExorcismSession -JSON
```

### Full Cleanup (User-Mode First, Then Elevation if Needed)
```powershell
Start-PrinterExorcismSession -FullCleanup
```

### System-Wide Purge (Requires Admin, Affects All Users)
```powershell
Start-PrinterExorcismSession -FullCleanup -Automated -TargetUser "SYSTEM" -CompareGPO
```

### For Demos or Maximum Theatrics
```powershell
Make-PrintersSuffer -FullCleanup -Automated -Verbosity Debug
```

---

## ğŸš Supported Parameters

| Flag             | Description |
|------------------|-------------|
| `-Discovery`     | Discover printers and linked registry keys only |
| `-FullCleanup`   | Perform complete cleanup (registry + printer objects) |
| `-CompareGPO`    | Compare current printers with GPO-deployed ones |
| `-Automated`     | Take all actions without prompting |
| `-RetryOnly`     | Re-run only failed steps from Phase 1 |
| `-TargetUser`    | Perform cleanup on another (offline) user hive |
| `-SystemWide`    | Clean printers across all user hives |
| `-Verbosity`     | Log level: Info, Warning, Critical, Debug |

---

## ğŸ“ Project Structure

```
PrinterExorcism
â”œâ”€â”€ PrinterExorcism.psm1
â”œâ”€â”€ PrinterExorcism.psd1
â”œâ”€â”€ Exorcist
â”‚   â”œâ”€â”€ Common.ps1
â”‚   â””â”€â”€ Private
â”‚       â”œâ”€â”€ PrinterExorcist.ps1
â”‚       â”œâ”€â”€ Watch-PrinterExorcism.ps1
â”‚       â””â”€â”€ Discover-Printers.ps1
```

---

## ğŸ§¾ License

This project is licensed under the **GNU General Public License v3.0**. See the [LICENSE](https://github.com/r0tifer/PrinterExorcism/blob/main/LICENSE) file for details.

---

## ğŸ‘¨â€ğŸ”§ Author

Created with righteous indignation by **Michael Levesque**.
